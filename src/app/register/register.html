<div class="login-container">
  <div class="left-column">
    <div class="image-container">
      <img src="loginProjello.png" alt="Welcome" class="login-image" />
      <img src="logoProjello.png" alt="Projello Logo" class="logo-image" />
    </div>
  </div>

  <div class="right-column">
    <div class="login-wrapper">
      <div class="login-card">
        <h1 class="title">Crea il tuo account</h1>
        <p class="subtitle">Registrati per iniziare</p>

        <form [formGroup]="form" (ngSubmit)="submit()">
          <div class="form-group">
            <label>Nome</label>
            <input type="text" formControlName="firstName" placeholder="Mario"
                   [class.invalid]="f.firstName.invalid && f.firstName.touched"/>
            @if (f.firstName.invalid && f.firstName.touched) {
              <small class="error-text">Il nome è obbligatorio (min 2)</small>
            }
          </div>

          <div class="form-group">
            <label>Cognome</label>
            <input type="text" formControlName="lastName" placeholder="Rossi"
                   [class.invalid]="f.lastName.invalid && f.lastName.touched"/>
            @if (f.lastName.invalid && f.lastName.touched) {
              <small class="error-text">Il cognome è obbligatorio (min 2)</small>
            }
          </div>

          <div class="form-group">
            <label>Username</label>
            <input type="text" formControlName="username" placeholder="mario.rossi"
                   [class.invalid]="f.username.invalid && f.username.touched"/>
            @if (f.username.invalid && f.username.touched) {
              <small class="error-text">3–20 caratteri</small>
            }
          </div>

          <div class="form-group">
            <label>Email</label>
            <input type="email" formControlName="email" placeholder="esempio@email.com"
                   [class.invalid]="f.email.invalid && f.email.touched"/>
            @if (f.email.invalid && f.email.touched) {
              <small class="error-text">Inserisci un'email valida</small>
            }
          </div>

          <div class="form-group">
            <label>Password</label>
            <input type="password" formControlName="password" placeholder="Minimo 8 caratteri"
                   [class.invalid]="f.password.invalid && f.password.touched"/>
            @if (f.password.invalid && f.password.touched) {
              <small class="error-text">Almeno 8 caratteri</small>
            }
          </div>

          <div class="form-group">
            <label>Conferma password</label>
            <input type="password" formControlName="confirmPassword" placeholder="Ripeti la password"
                   [class.invalid]="(f.confirmPassword.invalid && f.confirmPassword.touched) || (form.hasError('passwordMismatch') && f.confirmPassword.touched)"/>
            @if ((f.confirmPassword.invalid && f.confirmPassword.touched) || (form.hasError('passwordMismatch') && f.confirmPassword.touched)) {
              <small class="error-text">Le password non coincidono</small>
            }
          </div>

          <button type="submit" [disabled]="loading || form.invalid">
            @if (loading) { <span>Registrazione in corso...</span> } @else { <span>Registrati</span> }
          </button>

          @if (errorMessage) {
            <p class="error-message">{{ errorMessage }}</p>
          }

          <div class="register-link">
            <p>Hai già un account? <a routerLink="/login" class="register-anchor">Accedi</a></p>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
